# Monte Carlo Raytracer
![rendered cornell box scene](https://github.com/harveyives/montecarloraytracer/blob/master/img/finalimage.png?raw=true)

## What am I looking at?

The above image was generated by emitting over **200k photons** from the area light at the top of the scene, bouncing off each object, dispersing light naturally.

Then, over **4 million light rays** (one for each pixel) are fired into the scene, each of which bounces up to 16 times depending on the material of the objects it encounters.

At each bounce, the light ray samples the nearest photons to approximate the colour at that point, which are then combined to determine the colour of each pixel.

The result is a photorealistic image that accurately simulates the behaviour of light.

If this interests you, then please feel free to read the accompanying [report.pdf](report.pdf) that details how I created it.

### Things to observe:

- Colour bleed and soft shadows achieved through Global Illumination
- Regions of focused light as a result of the reflection and refraction of photons by translucent objects
- Procedurally generated 'marble' texture present on the teapot
- Phong shading to give low fidelity mesh objects a perfectly smooth surface


### Under the hood:

- Bounding spheres for mesh objects to accelerate renders
- Persistent photon maps that allow for the camera to be moved within the scene, without re-emitting hundreds of thousands of photons.
- Fresnel calculations to accurately model Total Internal Reflection (TIR) 


## Remark

The code quality is by no means exemplar. I wrote this under time constraints for an advanced computer graphics coursework module in my final year at university, and thus there are some questionable design decisions littered throughout. 

That said, I am proud to reveal it received a perfect score of 100/100.

**The raytracer operates without the use of OpenGL!** Not exactly a sane choice, but a requirement of the coursework. This meant that all vector calculations are carried out by hand!
Whilst this restriction increased difficulty tremendously, it also immensely improved my understanding of every intricate detail of modern raytracing graphics technologies.

The practical application of this code is rather limited, but I showcase it simply because it's by far the most **frustratingly enjoyable** piece of work I've ever completed. 10/10, would code again.

I plan to rewrite this entirely at some point using the skills and mistakes I have made in this program, perhaps in Rust.

## Compilation & Execution 
Compile using:  
`g++ -std=c++11 -o raytrace *.cpp alglib/*.cpp -lm -O3`

Then run with: 
`raytrace <width> <height> <generate_photon_map>`

>eg. `./raytrace 128 128 1` should take less than 30 seconds on modern computer hardware.

## TODO
- [x] clean up and make public
- [ ] proper parallelism
- [ ] better file support / scene setup
- [ ] depth of field?
- [ ] rewrite this all in Rust...
